import{s as ve,$ as xe,r as x,f as te,w as le,A as we,O as d,D as Se,F as e,Z as m,x as i,E as h,y as K,_ as w,I as f,a2 as R,G as de,L as ie,Q as T,u as N,H as j,a3 as Te,n as Be,K as oe,Y as Ne,R as Ce,a1 as Ee}from"./vendor-C_kCRdsv.js";import{h as Me}from"./focusUtils-B2fA3ttj.js";import{u as fe,t as me,s as ee,c as ke,d as ne,i as pe,w as Ue,x as _e,y as Le,z as be,g as he,A as Ae}from"./index-CET3MO9v.js";import{u as De,_ as Pe}from"./PublishMessageModal.vue_vue_type_script_setup_true_lang-DXzMVQZ7.js";import{_ as Ve}from"./BaseModal.vue_vue_type_script_setup_true_lang-CbCA5KVJ.js";import{_ as $e}from"./ConfirmationModal.vue_vue_type_script_setup_true_lang-BtIlvEIB.js";import"./pinia-B2SWLoi0.js";import"./query-BV4EBN_X.js";import"./messageTemplates-BIHD0qL0.js";import"./DocumentDuplicateIcon-Bk0JYA52.js";const Re={class:"space-y-4 sm:space-y-6"},je={class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 sm:p-4"},Oe={class:"space-y-3 sm:space-y-4"},qe={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Ie={class:"flex items-center"},Fe={key:0,class:"mt-2"},Qe={class:"space-y-2"},ze=["onUpdate:modelValue"],He=["onUpdate:modelValue"],Ye=["onClick"],We={class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3 sm:p-4"},Xe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-3 sm:mb-4 space-y-2 sm:space-y-0"},Ze={key:0,class:"text-center py-4"},Ke={key:1,class:"space-y-3 sm:space-y-4"},Ge={class:"flex items-center justify-between mb-3"},Je={class:"text-sm font-medium text-gray-900 dark:text-white"},et=["onClick"],tt={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4"},at=["onUpdate:modelValue"],st={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},rt=["onUpdate:modelValue"],ot={key:0,class:"lg:col-span-2"},lt=["onUpdate:modelValue"],nt=["onUpdate:modelValue"],dt={class:"lg:col-span-2 flex items-center"},it={class:"flex items-center mb-2"},ut=["onUpdate:modelValue"],ct={class:"lg:col-span-2"},mt={class:"flex items-center mb-2"},pt=["onUpdate:modelValue"],gt={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-2"},bt=["onUpdate:modelValue"],yt=["onUpdate:modelValue"],vt={class:"lg:col-span-2"},xt={class:"flex items-center mb-2"},ft=["onUpdate:modelValue"],kt={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-2"},ht=["onUpdate:modelValue"],wt=["onUpdate:modelValue"],St=ve({__name:"CreateTopicModal",props:{modelValue:{type:Boolean}},emits:["update:modelValue","topic-created"],setup(V,{emit:Y}){const B=V,z=Y,ae=xe(),C=fe(),O=x(),k=x(!1),v=x({name:"",messageRetentionDuration:"7d",useSchema:!1,schemaName:"",labels:[{key:"",value:""}]}),P=x({}),D=x([]),F=te({get:()=>B.modelValue,set:c=>z("update:modelValue",c)}),U=te(()=>ae.params.projectId),L=te(()=>[{label:"Cancel",handler:E,variant:"secondary"},{label:`Create Topic${D.value.length>0?` & ${D.value.length} Subscription${D.value.length>1?"s":""}`:""}`,handler:I,variant:"primary",loading:k.value,disabled:!v.value.name.trim()||k.value}]),S=c=>c.trim()?/^[a-zA-Z][a-zA-Z0-9-_]*$/.test(c)?c.length>255?"Topic name must be less than 255 characters":"":"Topic name must start with a letter and contain only letters, numbers, hyphens, and underscores":"Topic name is required",q=c=>{const l={};return c.name.trim()?/^[a-zA-Z][a-zA-Z0-9-_]*$/.test(c.name)||(l.name="Subscription name must start with a letter and contain only letters, numbers, hyphens, and underscores"):l.name="Subscription name is required",c.deliveryType==="push"&&!c.pushEndpoint?.trim()&&(l.pushEndpoint="Push endpoint is required for push subscriptions"),l},I=async()=>{const c=S(v.value.name);if(c){P.value.name=c;return}let l=!1;if(D.value.forEach(n=>{const _=q(n);n.errors=_,Object.keys(_).length>0&&(l=!0)}),!l){k.value=!0;try{const n=v.value.labels.filter(u=>u.key.trim()&&u.value.trim()).reduce((u,H)=>(u[H.key.trim()]=H.value.trim(),u),{}),_={name:v.value.name.trim(),messageRetentionDuration:v.value.messageRetentionDuration,...Object.keys(n).length>0&&{labels:n},...v.value.useSchema&&v.value.schemaName&&{schemaSettings:{schema:`projects/${U.value}/schemas/${v.value.schemaName}`,encoding:"JSON"}}};await me.createTopic(U.value,_);for(const u of D.value){const H={name:u.name.trim(),topic:`projects/${U.value}/topics/${v.value.name.trim()}`,ackDeadlineSeconds:u.ackDeadlineSeconds,enableMessageOrdering:u.enableMessageOrdering,pushConfig:u.deliveryType==="push"?{pushEndpoint:u.pushEndpoint}:void 0,deadLetterPolicy:u.useDeadLetter?{deadLetterTopic:u.deadLetterTopic?`projects/${U.value}/topics/${u.deadLetterTopic}`:void 0,maxDeliveryAttempts:u.maxDeliveryAttempts||5}:void 0,retryPolicy:u.useRetryPolicy?{minimumBackoff:u.minimumBackoff||"1s",maximumBackoff:u.maximumBackoff||"600s"}:void 0};await ee.createSubscription(U.value,H)}C.showToast({type:"success",title:"Resources Created",message:`Topic "${v.value.name}" ${D.value.length>0?`and ${D.value.length} subscription${D.value.length>1?"s":""} `:""}created successfully`}),F.value=!1,z("topic-created"),y()}catch(n){console.error("Error creating topic/subscriptions:",n),C.showToast({type:"error",title:"Creation Failed",message:n.message||"Failed to create topic and subscriptions"})}finally{k.value=!1}}},E=()=>{k.value||(F.value=!1,y())},y=()=>{v.value={name:"",messageRetentionDuration:"7d",useSchema:!1,schemaName:"",labels:[{key:"",value:""}]},P.value={},D.value=[],k.value=!1},W=c=>{P.value[c]&&delete P.value[c]},M=()=>{v.value.labels.push({key:"",value:""})},A=c=>{v.value.labels.splice(c,1)},a=()=>{D.value.push({name:"",deliveryType:"pull",ackDeadlineSeconds:60,enableMessageOrdering:!1,useDeadLetter:!1,maxDeliveryAttempts:5,useRetryPolicy:!1,minimumBackoff:"1s",maximumBackoff:"600s"})},X=c=>{D.value.splice(c,1)};return le(()=>B.modelValue,async c=>{c&&(await Be(),O.value?.focus())}),(c,l)=>(d(),we(Ve,{modelValue:F.value,"onUpdate:modelValue":l[5]||(l[5]=n=>F.value=n),title:"Create Topic",size:"xl",actions:L.value,onClose:E},{default:Se(()=>[e("div",Re,[e("div",je,[l[12]||(l[12]=e("h3",{class:"text-sm font-medium text-gray-900 dark:text-white mb-3 sm:mb-4"},"Topic Configuration",-1)),e("div",Oe,[e("div",null,[l[6]||(l[6]=e("label",{for:"topic-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Topic Name * ",-1)),m(e("input",{id:"topic-name",ref_key:"topicNameInput",ref:O,"onUpdate:modelValue":l[0]||(l[0]=n=>v.value.name=n),type:"text",placeholder:"Enter topic name (e.g., my-topic)",class:K(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":P.value.name}]),onInput:l[1]||(l[1]=n=>W("name"))},null,34),[[w,v.value.name]]),P.value.name?(d(),i("p",qe,f(P.value.name),1)):h("",!0)]),e("div",null,[l[7]||(l[7]=e("label",{for:"retention",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Message Retention Duration ",-1)),m(e("input",{id:"retention","onUpdate:modelValue":l[2]||(l[2]=n=>v.value.messageRetentionDuration=n),type:"text",placeholder:"7d (e.g., 1h, 24h, 7d)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,v.value.messageRetentionDuration]]),l[8]||(l[8]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Note: Emulator retains all messages indefinitely regardless of this setting ",-1))]),e("div",null,[e("label",Ie,[m(e("input",{"onUpdate:modelValue":l[3]||(l[3]=n=>v.value.useSchema=n),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,v.value.useSchema]]),l[9]||(l[9]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Avro Schema",-1))]),v.value.useSchema?(d(),i("div",Fe,[m(e("input",{"onUpdate:modelValue":l[4]||(l[4]=n=>v.value.schemaName=n),type:"text",placeholder:"Schema name (optional)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,v.value.schemaName]]),l[10]||(l[10]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Only Avro schemas are supported in the emulator ",-1))])):h("",!0)]),e("div",null,[l[11]||(l[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Labels (Optional) ",-1)),e("div",Qe,[(d(!0),i(de,null,ie(v.value.labels,(n,_)=>(d(),i("div",{key:_,class:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2"},[m(e("input",{"onUpdate:modelValue":u=>n.key=u,type:"text",placeholder:"Key",class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,ze),[[w,n.key]]),m(e("input",{"onUpdate:modelValue":u=>n.value=u,type:"text",placeholder:"Value",class:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,He),[[w,n.value]]),e("button",{onClick:u=>A(_),class:"p-2 text-gray-400 hover:text-red-500 transition-colors self-start sm:self-auto"},[T(N(ke),{class:"w-4 h-4"})],8,Ye)]))),128)),e("button",{onClick:M,class:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium"}," + Add Label ")])])])]),e("div",We,[e("div",Xe,[l[14]||(l[14]=e("h3",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Create Subscriptions (Optional)",-1)),e("button",{onClick:a,class:"inline-flex items-center justify-center px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors w-full sm:w-auto"},[T(N(ne),{class:"w-4 h-4 mr-1"}),l[13]||(l[13]=j(" Add Subscription ",-1))])]),D.value.length===0?(d(),i("div",Ze,[T(N(pe),{class:"mx-auto w-8 h-8 text-gray-400 mb-2"}),l[15]||(l[15]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"No subscriptions added",-1)),l[16]||(l[16]=e("p",{class:"text-xs text-gray-400 dark:text-gray-500"},"You can add subscriptions later if needed",-1))])):(d(),i("div",Ke,[(d(!0),i(de,null,ie(D.value,(n,_)=>(d(),i("div",{key:_,class:"border border-gray-200 dark:border-gray-600 rounded-lg p-3 sm:p-4"},[e("div",Ge,[e("h4",Je,"Subscription "+f(_+1),1),e("button",{onClick:u=>X(_),class:"text-gray-400 hover:text-red-500 transition-colors"},[T(N(ke),{class:"w-4 h-4"})],8,et)]),e("div",tt,[e("div",null,[l[17]||(l[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Name * ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.name=u,type:"text",placeholder:"subscription-name",class:K(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":n.errors?.name}])},null,10,at),[[w,n.name]]),n.errors?.name?(d(),i("p",st,f(n.errors.name),1)):h("",!0)]),e("div",null,[l[19]||(l[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Delivery Type ",-1)),m(e("select",{"onUpdate:modelValue":u=>n.deliveryType=u,class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},[...l[18]||(l[18]=[e("option",{value:"pull"},"Pull",-1),e("option",{value:"push"},"Push",-1)])],8,rt),[[Te,n.deliveryType]])]),n.deliveryType==="push"?(d(),i("div",ot,[l[20]||(l[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Push Endpoint * ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.pushEndpoint=u,type:"url",placeholder:"https://example.com/webhook",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,lt),[[w,n.pushEndpoint]])])):h("",!0),e("div",null,[l[21]||(l[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Ack Deadline (seconds) ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.ackDeadlineSeconds=u,type:"number",min:"10",max:"600",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,nt),[[w,n.ackDeadlineSeconds,void 0,{number:!0}]])]),e("div",dt,[e("label",it,[m(e("input",{"onUpdate:modelValue":u=>n.enableMessageOrdering=u,type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,8,ut),[[R,n.enableMessageOrdering]]),l[22]||(l[22]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Message Ordering",-1))])]),e("div",ct,[e("label",mt,[m(e("input",{"onUpdate:modelValue":u=>n.useDeadLetter=u,type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,8,pt),[[R,n.useDeadLetter]]),l[23]||(l[23]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Dead Letter Topic",-1))]),n.useDeadLetter?(d(),i("div",gt,[e("div",null,[l[24]||(l[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Dead Letter Topic ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.deadLetterTopic=u,type:"text",placeholder:"dead-letter-topic-name",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,bt),[[w,n.deadLetterTopic]])]),e("div",null,[l[25]||(l[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Max Delivery Attempts ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.maxDeliveryAttempts=u,type:"number",min:"1",max:"100",placeholder:"Max delivery attempts (5)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,yt),[[w,n.maxDeliveryAttempts,void 0,{number:!0}]])])])):h("",!0)]),e("div",vt,[e("label",xt,[m(e("input",{"onUpdate:modelValue":u=>n.useRetryPolicy=u,type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,8,ft),[[R,n.useRetryPolicy]]),l[26]||(l[26]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Retry Policy",-1))]),n.useRetryPolicy?(d(),i("div",kt,[e("div",null,[l[27]||(l[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Minimum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.minimumBackoff=u,type:"text",placeholder:"1s",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,ht),[[w,n.minimumBackoff]])]),e("div",null,[l[28]||(l[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Maximum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":u=>n.maximumBackoff=u,type:"text",placeholder:"600s",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,8,wt),[[w,n.maximumBackoff]])])])):h("",!0)])])]))),128))]))])])]),_:1},8,["modelValue","actions"]))}}),ye=V=>{if(V.response?.status===409)return"ALREADY_EXISTS: Resource already exists";if(V.response?.status===404)return"NOT_FOUND: Resource not found";if(V.response?.status===400)return"INVALID_REQUEST: Invalid request parameters";if(V.response?.status===403)return"PERMISSION_DENIED: Access denied";if(V.response?.status===500)return"INTERNAL_ERROR: Server internal error";if(V.message?.includes("ALREADY_EXISTS")||V.message?.includes("NOT_FOUND")||V.message?.includes("PERMISSION_DENIED")||V.message?.includes("INVALID_"))return V.message;if(V.message?.includes("Request failed with status code")){const Y=V.message.match(/status code (\d+)/);if(Y){const B=parseInt(Y[1]);switch(B){case 409:return"ALREADY_EXISTS: Resource already exists";case 404:return"NOT_FOUND: Resource not found";case 400:return"INVALID_REQUEST: Invalid request parameters";case 403:return"PERMISSION_DENIED: Access denied";case 500:return"INTERNAL_ERROR: Server internal error";default:return`HTTP_ERROR: Request failed (${B})`}}}return V.message||"Unknown error occurred"},Tt={key:0,class:"flex items-center justify-center py-8"},_t={key:1,class:"space-y-6"},Dt={class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},Vt={class:"space-y-4"},$t={class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300"},Bt={class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},Nt={class:"flex items-center mb-2"},Ct={key:0,class:"mt-2"},Et={class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},Mt={class:"flex items-center justify-between mb-4"},Ut={key:0,class:"flex items-center justify-center py-4"},Lt={key:1,class:"text-center py-4"},At={key:2,class:"space-y-3"},Pt={key:0,class:"space-y-4"},Rt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jt={class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300"},Ot={class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300"},qt={key:0,class:"md:col-span-2"},It={key:1,class:"md:col-span-2 space-y-3"},Ft={class:"px-3 py-2 bg-gray-100 dark:bg-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300"},Qt={class:"flex items-center space-x-4"},zt={class:"flex items-center"},Ht={class:"flex items-center"},Yt={class:"md:col-span-2"},Wt={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Xt={class:"md:col-span-2 flex items-center"},Zt={class:"flex items-center mb-2"},Kt={class:"md:col-span-2"},Gt={class:"flex items-center mb-2"},Jt={key:0,class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},ea={class:"md:col-span-2"},ta={class:"flex items-center mb-2"},aa={key:0,class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},sa={key:1},ra={class:"flex items-center justify-between mb-2"},oa={class:"flex items-center space-x-2"},la=["onClick","disabled"],na=["onClick","disabled"],da={class:"grid grid-cols-1 sm:grid-cols-4 gap-2 text-xs text-gray-600 dark:text-gray-400"},ia={class:"flex items-center justify-center"},ua={class:"inline-flex items-center px-1.5 py-0.5 ml-1 text-xs rounded bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"},ca={class:"flex items-center justify-center"},ma={key:0,class:"flex items-center justify-center"},pa={key:1,class:"flex items-center justify-center"},ga={class:"flex items-center justify-center"},ba={key:0,class:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs text-gray-600 dark:text-gray-400"},ya={key:0},va={key:1};const xa={key:4,class:"mt-4 border border-gray-200 dark:border-gray-600 rounded-lg p-4 bg-white dark:bg-gray-800"},fa={class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},ka={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ha={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},wa={key:0,class:"md:col-span-2"},Sa={key:1,class:"md:col-span-2 space-y-3"},Ta={class:"flex items-center space-x-4"},_a={class:"flex items-center"},Da={class:"flex items-center"},Va={class:"md:col-span-2"},$a={class:"md:col-span-2 flex items-center"},Ba={class:"flex items-center mb-2"},Na={class:"md:col-span-2"},Ca={class:"flex items-center mb-2"},Ea={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"},Ma={class:"md:col-span-2"},Ua={class:"flex items-center mb-2"},La={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"},Aa=ve({__name:"TopicDetailsModal",props:{modelValue:{type:Boolean},topicName:{},projectId:{}},emits:["update:modelValue","topic-updated","subscriptions-changed"],setup(V,{emit:Y}){const B=V,z=Y,ae=xe(),C=fe(),O=De(),k=Ue(),v=x(!1),P=x(!1),D=x(!1),F=x(!1),U=x(!1),L=x(!1),S=x(null),q=x([]),I=x(!1),E=x(!1),y=x(null),W=x(!1),M=x(null),A=x({messageRetentionDuration:"7d",useSchema:!1,schemaName:""}),a=x({name:"",deliveryType:"pull",ackDeadlineSeconds:60,enableMessageOrdering:!1,enableDeadLetter:!1,maxDeliveryAttempts:5,enableRetryPolicy:!1,minimumBackoff:"10s",maximumBackoff:"600s"}),X=te({get:()=>B.modelValue,set:r=>z("update:modelValue",r)}),c=te(()=>B.projectId||ae.params.projectId),l=te(()=>[{label:"Cancel",handler:ue,variant:"secondary"},{label:"Update",handler:ge,variant:"primary",loading:D.value||L.value,disabled:D.value||L.value}]),n=r=>{const t=r.split("/");return t[t.length-1]||r},_=r=>{if(!r||typeof r!="string")return"Unknown";const t=r.split("/");return t[t.length-1]||r},u=async()=>{if(!(!B.topicName||!c.value)){v.value=!0;try{let r=O.getTopicByName(B.topicName,c.value);r||(r=await me.getTopic(c.value,B.topicName),r={...r,messageRetentionDuration:r.messageRetentionDuration||"7d",labels:r.labels||{},messageCount:r.messageCount||0,subscriptionsCount:r.subscriptionsCount||0,createdAt:r.createdAt||new Date,updatedAt:r.updatedAt||new Date}),S.value=r,A.value={messageRetentionDuration:r.messageRetentionDuration||"7d",useSchema:!!r.schemaSettings,schemaName:r.schemaSettings?.schema?n(r.schemaSettings.schema):""}}catch(r){console.error("Error loading topic:",r),C.showToast({type:"error",title:"Error",message:"Failed to load topic details"})}finally{v.value=!1}}},H=async()=>{if(!(!B.topicName||!c.value)){P.value=!0;try{const r=await ee.getSubscriptions(c.value),t=`projects/${c.value}/topics/${B.topicName}`,$=(Array.isArray(r)?r:[]).filter(b=>{const re=b.topicName||b.topic||b.topicId||b.topicPath;return re===t||re===B.topicName||re?.endsWith(`/topics/${B.topicName}`)||!1});q.value=$,S.value&&(S.value.subscriptionsCount=$.length)}catch(r){console.error("Error loading subscriptions:",r)}finally{P.value=!1}}},ge=async()=>{if(!(!S.value||!c.value)){if(y.value||I.value){console.log("Calling saveSubscription"),await Q();return}D.value=!0;try{const r={labels:{},messageRetentionDuration:A.value.messageRetentionDuration,schemaSettings:A.value.useSchema&&A.value.schemaName?{schema:`projects/${c.value}/schemas/${A.value.schemaName}`,encoding:"JSON"}:void 0,createdAt:S.value.createdAt,messageCount:S.value.messageCount,subscriptionsCount:S.value.subscriptionsCount},t=await me.updateTopic(c.value,n(S.value.name),r),s={...S.value,...t};S.value=s;const $=O.topics,b=$.findIndex(re=>n(re.name)===n(S.value.name)&&re.projectId===c.value);b!==-1?$[b]=s:$.push(s),C.showToast({type:"success",title:"Topic Updated",message:`Topic "${n(S.value.name)}" has been updated successfully`}),z("topic-updated"),X.value=!1}catch(r){console.error("Error updating topic:",r),C.showToast({type:"error",title:"Update Failed",message:"Failed to update topic"})}finally{D.value=!1}}},ue=()=>{!D.value&&!F.value&&!L.value&&(X.value=!1,I.value=!1,E.value=!1,y.value=null)},ce=r=>{y.value=r,I.value=!1;const t=_(r.name);let s="pull";r.pushConfig?.pushEndpoint?s="push":r.bigqueryConfig&&(s="bigquery"),a.value={name:t,deliveryType:s,ackDeadlineSeconds:r.ackDeadlineSeconds||60,enableMessageOrdering:r.enableMessageOrdering||!1,pushEndpoint:r.pushConfig?.pushEndpoint||"",bigqueryTable:r.bigqueryConfig?.table||"",useTopicSchema:r.bigqueryConfig?.useTopicSchema||!1,writeMetadata:r.bigqueryConfig?.writeMetadata||!1,deadLetterTopic:r.deadLetterPolicy?.deadLetterTopic?n(r.deadLetterPolicy.deadLetterTopic):"",maxDeliveryAttempts:r.deadLetterPolicy?.maxDeliveryAttempts||5,minimumBackoff:r.retryPolicy?.minimumBackoff||"",maximumBackoff:r.retryPolicy?.maximumBackoff||"",enableDeadLetter:!!r.deadLetterPolicy,enableRetryPolicy:!!r.retryPolicy}},g=()=>{y.value=null,E.value=!1,I.value=!0,a.value={name:"",deliveryType:"pull",ackDeadlineSeconds:60,enableMessageOrdering:!1,enableDeadLetter:!1,maxDeliveryAttempts:5,enableRetryPolicy:!1,minimumBackoff:"10s",maximumBackoff:"600s"}},o=()=>{I.value=!1,E.value=!1,y.value=null,a.value={name:"",deliveryType:"pull",ackDeadlineSeconds:60,enableMessageOrdering:!1,enableDeadLetter:!1,maxDeliveryAttempts:5,enableRetryPolicy:!1,minimumBackoff:"10s",maximumBackoff:"600s"}},p=async()=>{if(!S.value||!c.value)return;const r={};if(a.value.name.trim()||(r.name="Subscription name is required"),(a.value.ackDeadlineSeconds<10||a.value.ackDeadlineSeconds>600)&&(r.ackDeadlineSeconds="Ack deadline must be between 10 and 600 seconds"),a.value.deliveryType==="push"&&!a.value.pushEndpoint?.trim()&&(r.pushEndpoint="Push endpoint is required for push subscriptions"),a.value.deliveryType==="bigquery"&&!a.value.bigqueryTable?.trim()&&(r.bigqueryTable="BigQuery table is required for BigQuery subscriptions"),a.value.enableDeadLetter&&!a.value.deadLetterTopic?.trim()&&(r.deadLetterTopic="Dead letter topic is required when dead letter policy is enabled"),a.value.enableRetryPolicy&&(a.value.minimumBackoff?.trim()||(r.minimumBackoff="Minimum backoff is required when retry policy is enabled"),a.value.maximumBackoff?.trim()||(r.maximumBackoff="Maximum backoff is required when retry policy is enabled")),Object.keys(r).length>0){a.value.errors=r;const t=Object.values(r),s=t.length===1?t[0]:`Validation errors: ${t.join(", ")}`;k.error(s,{timeout:6e3});return}F.value=!0;try{const t={name:a.value.name.trim(),topic:S.value.name,ackDeadlineSeconds:a.value.ackDeadlineSeconds,enableMessageOrdering:a.value.enableMessageOrdering};a.value.deliveryType==="push"&&a.value.pushEndpoint&&(t.pushConfig={pushEndpoint:a.value.pushEndpoint}),a.value.deliveryType==="bigquery"&&a.value.bigqueryTable&&(t.bigqueryConfig={table:a.value.bigqueryTable,useTopicSchema:a.value.useTopicSchema,writeMetadata:a.value.writeMetadata}),a.value.enableDeadLetter&&a.value.deadLetterTopic&&(t.deadLetterPolicy={deadLetterTopic:a.value.deadLetterTopic,maxDeliveryAttempts:a.value.maxDeliveryAttempts}),a.value.enableRetryPolicy&&a.value.minimumBackoff&&a.value.maximumBackoff&&(t.retryPolicy={minimumBackoff:a.value.minimumBackoff,maximumBackoff:a.value.maximumBackoff}),await ee.createSubscription(c.value,t),C.showToast({type:"success",title:"Subscription Created",message:`Subscription "${a.value.name}" created successfully`}),await H(),o(),z("subscriptions-changed")}catch(t){console.error("Error creating subscription:",t),console.error("Error details:",{status:t.response?.status,message:t.message,data:t.response?.data,fullError:t}),t.response?.status===409||t.message?.includes("ALREADY_EXISTS")||t.response?.data?.message?.includes("ALREADY_EXISTS")?k.warning(`A subscription named "${a.value.name}" already exists for this topic. Please choose a different name.`,{timeout:8e3}):t.response?.status===404||t.message?.includes("NOT_FOUND")?k.error("The topic no longer exists. Please refresh the page to see the current state.",{timeout:6e3}):t.response?.status===400?k.error("The subscription configuration is invalid. Please check your settings and try again.",{timeout:5e3}):k.error(`Failed to create subscription: ${ye(t)}`,{timeout:5e3})}finally{F.value=!1}},Q=async()=>{console.log("saveSubscription called - editingSubscription.value:",y.value),console.log("showNewSubscriptionForm.value:",I.value),y.value?await Z():await p()},Z=async()=>{if(console.log("saveEditedSubscription called"),console.log("editingSubscription.value:",y.value),console.log("currentProjectId.value:",c.value),console.log("newSubscription.value:",a.value),!y.value||!c.value)return;const r={};(a.value.ackDeadlineSeconds<10||a.value.ackDeadlineSeconds>600)&&(r.ackDeadlineSeconds="Ack deadline must be between 10 and 600 seconds"),console.log("editingSubscription pushConfig:",y.value.pushConfig),console.log("Has existing pushEndpoint?",y.value.pushConfig?.pushEndpoint);const t=y.value.pushConfig?.pushEndpoint&&typeof y.value.pushConfig=="object";if(a.value.deliveryType==="push"&&!a.value.pushEndpoint?.trim()&&!t&&(r.pushEndpoint="Push endpoint is required for push subscriptions"),a.value.enableDeadLetter&&!a.value.deadLetterTopic?.trim()&&(r.deadLetterTopic="Dead letter topic is required when dead letter policy is enabled"),a.value.enableRetryPolicy&&(a.value.minimumBackoff?.trim()||(r.minimumBackoff="Minimum backoff is required when retry policy is enabled"),a.value.maximumBackoff?.trim()||(r.maximumBackoff="Maximum backoff is required when retry policy is enabled")),console.log("Validation errors:",r),Object.keys(r).length>0){a.value.errors=r,console.log("Validation failed, returning early - subscription not deleted");const s=Object.values(r),$=s.length===1?s[0]:`Validation errors: ${s.join(", ")}`;k.error($,{timeout:6e3});return}console.log("Validation passed, proceeding with delete+recreate"),L.value=!0;try{const s=_(y.value.name),$={name:y.value.name,topic:y.value.topic,ackDeadlineSeconds:a.value.ackDeadlineSeconds,enableMessageOrdering:a.value.enableMessageOrdering};a.value.deliveryType==="push"?$.pushConfig={pushEndpoint:a.value.pushEndpoint||y.value.pushConfig?.pushEndpoint||""}:y.value.pushConfig?.pushEndpoint&&($.pushConfig=y.value.pushConfig),a.value.deliveryType==="bigquery"&&($.bigqueryConfig={table:a.value.bigqueryTable,useTopicSchema:a.value.useTopicSchema,writeMetadata:a.value.writeMetadata}),a.value.enableDeadLetter?$.deadLetterPolicy={deadLetterTopic:a.value.deadLetterTopic,maxDeliveryAttempts:a.value.maxDeliveryAttempts}:$.deadLetterPolicy=null,a.value.enableRetryPolicy?$.retryPolicy={minimumBackoff:a.value.minimumBackoff,maximumBackoff:a.value.maximumBackoff}:$.retryPolicy=null,console.log("Deleting and recreating subscription with data:",$),console.log("Step 1: Deleting existing subscription..."),await ee.deleteSubscription(c.value,s),console.log("Step 2: Creating new subscription with updated settings...");const b={name:s,topic:y.value.topic,ackDeadlineSeconds:a.value.ackDeadlineSeconds,enableMessageOrdering:a.value.enableMessageOrdering};a.value.deliveryType==="push"&&(b.pushConfig={pushEndpoint:a.value.pushEndpoint||y.value.pushConfig?.pushEndpoint||""}),a.value.deliveryType==="bigquery"&&(b.bigqueryConfig={table:a.value.bigqueryTable,useTopicSchema:a.value.useTopicSchema,writeMetadata:a.value.writeMetadata}),a.value.enableDeadLetter&&(b.deadLetterPolicy={deadLetterTopic:a.value.deadLetterTopic,maxDeliveryAttempts:a.value.maxDeliveryAttempts}),a.value.enableRetryPolicy&&(b.retryPolicy={minimumBackoff:a.value.minimumBackoff,maximumBackoff:a.value.maximumBackoff}),console.log("Creating subscription with request:",b),await ee.createSubscription(c.value,b),console.log("Subscription updated successfully"),C.showToast({type:"success",title:"Subscription Updated",message:`Subscription "${a.value.name}" updated successfully`}),await H(),o(),z("subscriptions-changed")}catch(s){console.error("Error updating subscription (delete+create):",s),s.response?.status===409||s.message?.includes("ALREADY_EXISTS")?k.warning("The subscription could not be updated because it still exists. The delete operation may have failed. Please try refreshing the page and try again.",{timeout:8e3}):s.response?.status===404||s.message?.includes("NOT_FOUND")?k.error("The topic no longer exists. Please refresh the page to see the current state.",{timeout:6e3}):k.error(`Failed to update subscription: ${ye(s)}`,{timeout:5e3})}finally{L.value=!1}},G=r=>{M.value=r,W.value=!0},se=async()=>{if(!M.value||!c.value||U.value)return;const r=M.value,t=_(r.name);U.value=!0;try{console.log("Attempting to delete subscription:",t),await ee.deleteSubscription(c.value,t),console.log("Delete API call successful"),C.showToast({type:"success",title:"Subscription Deleted",message:`Subscription "${t}" deleted successfully`}),q.value=q.value.filter(s=>_(s.name)!==t),await H()}catch(s){console.error("Error deleting subscription:",s),s.response?.status===404?(q.value=q.value.filter($=>_($.name)!==t),C.showToast({type:"info",title:"Subscription Removed",message:`Subscription "${t}" was already deleted or doesn't exist`})):k.error(`Failed to delete subscription: ${ye(s)}`,{timeout:5e3})}finally{U.value=!1,W.value=!1,M.value=null}z("subscriptions-changed")},J=()=>{W.value=!1,M.value=null};return le(()=>[B.modelValue,B.topicName,c.value],async([r])=>{r&&B.topicName&&(await u(),await H())},{immediate:!0}),(r,t)=>(d(),we(Ve,{modelValue:X.value,"onUpdate:modelValue":t[40]||(t[40]=s=>X.value=s),title:`Edit ${S.value?.name?n(S.value.name):"Loading..."}`,size:"5xl",actions:l.value,onClose:ue},{default:Se(()=>[v.value?(d(),i("div",Tt,[...t[41]||(t[41]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-400"},"Loading topic details...",-1)])])):S.value?(d(),i("div",_t,[e("div",Dt,[t[47]||(t[47]=e("h3",{class:"text-sm font-medium text-gray-900 dark:text-white mb-4"},"Topic Configuration",-1)),e("div",Vt,[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Topic Name ",-1)),e("div",$t,f(n(S.value.name)),1),e("p",Bt," Full path: "+f(S.value.name),1)]),e("div",null,[t[43]||(t[43]=e("label",{for:"retention",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Message Retention Duration ",-1)),m(e("input",{id:"retention","onUpdate:modelValue":t[0]||(t[0]=s=>A.value.messageRetentionDuration=s),type:"text",placeholder:"7d (e.g., 1h, 24h, 7d)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,A.value.messageRetentionDuration]]),t[44]||(t[44]=e("p",{class:"mt-1 text-xs text-amber-600 dark:text-amber-400"}," ⚠️ Limitation: Configurable message retention is not supported - emulator retains all messages indefinitely ",-1))]),e("div",null,[e("label",Nt,[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>A.value.useSchema=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,A.value.useSchema]]),t[45]||(t[45]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Avro Schema",-1))]),A.value.useSchema?(d(),i("div",Ct,[m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>A.value.schemaName=s),type:"text",placeholder:"Schema name",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,A.value.schemaName]]),t[46]||(t[46]=e("p",{class:"mt-1 text-xs text-amber-600 dark:text-amber-400"}," ⚠️ Limitation: Only Avro schemas are supported - Protocol Buffers are not supported in the emulator ",-1))])):h("",!0)])])]),e("div",Et,[e("div",Mt,[t[49]||(t[49]=e("h3",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Subscriptions",-1)),e("button",{onClick:g,class:"inline-flex items-center px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors"},[T(N(ne),{class:"w-4 h-4 mr-1"}),t[48]||(t[48]=j(" Add Subscription ",-1))])]),P.value?(d(),i("div",Ut,[...t[50]||(t[50]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-3 text-sm text-gray-600 dark:text-gray-400"},"Loading subscriptions...",-1)])])):q.value.length===0&&!I.value?(d(),i("div",Lt,[T(N(pe),{class:"mx-auto w-8 h-8 text-gray-400 mb-2"}),t[51]||(t[51]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"No subscriptions found",-1)),t[52]||(t[52]=e("p",{class:"text-xs text-gray-400 dark:text-gray-500"},"Create a subscription to start receiving messages",-1))])):(d(),i("div",At,[(d(!0),i(de,null,ie(q.value,(s,$)=>(d(),i("div",{key:s.name||$,class:"border border-gray-200 dark:border-gray-600 rounded-lg p-3 bg-white dark:bg-gray-800"},[y.value&&_(y.value.name)===_(s.name)?(d(),i("div",Pt,[t[70]||(t[70]=e("h4",{class:"text-sm font-medium text-gray-900 dark:text-white mb-3"},"Edit Subscription",-1)),e("div",Rt,[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Name ",-1)),e("div",jt,f(a.value.name),1),t[54]||(t[54]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Subscription names cannot be changed after creation ",-1))]),e("div",null,[t[55]||(t[55]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Delivery Type ",-1)),e("div",Ot,f(a.value.deliveryType.charAt(0).toUpperCase()+a.value.deliveryType.slice(1)),1),t[56]||(t[56]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," Delivery type cannot be changed after creation ",-1))]),a.value.deliveryType==="push"?(d(),i("div",qt,[t[57]||(t[57]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Push Endpoint * ",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=b=>a.value.pushEndpoint=b),type:"url",placeholder:"https://example.com/webhook",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.pushEndpoint]])])):h("",!0),a.value.deliveryType==="bigquery"?(d(),i("div",It,[e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," BigQuery Table ",-1)),e("div",Ft,f(a.value.bigqueryTable),1),t[59]||(t[59]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," BigQuery table cannot be changed after creation ",-1))]),e("div",Qt,[e("label",zt,[m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=b=>a.value.useTopicSchema=b),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.useTopicSchema]]),t[60]||(t[60]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Topic Schema",-1))]),e("label",Ht,[m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=b=>a.value.writeMetadata=b),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.writeMetadata]]),t[61]||(t[61]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Write Metadata",-1))])])])):h("",!0),e("div",Yt,[t[62]||(t[62]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Ack Deadline (seconds) ",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=b=>a.value.ackDeadlineSeconds=b),type:"number",min:"10",max:"600",class:K(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":a.value.errors?.ackDeadlineSeconds}])},null,2),[[w,a.value.ackDeadlineSeconds,void 0,{number:!0}]]),a.value.errors?.ackDeadlineSeconds?(d(),i("p",Wt,f(a.value.errors.ackDeadlineSeconds),1)):h("",!0)]),e("div",Xt,[e("label",Zt,[m(e("input",{"onUpdate:modelValue":t[7]||(t[7]=b=>a.value.enableMessageOrdering=b),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableMessageOrdering]]),t[63]||(t[63]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Message Ordering",-1))])]),e("div",Kt,[e("label",Gt,[m(e("input",{"onUpdate:modelValue":t[8]||(t[8]=b=>a.value.enableDeadLetter=b),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableDeadLetter]]),t[64]||(t[64]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Dead Letter Policy",-1))]),a.value.enableDeadLetter?(d(),i("div",Jt,[e("div",null,[t[65]||(t[65]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Dead Letter Topic ",-1)),m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=b=>a.value.deadLetterTopic=b),type:"text",placeholder:"dead-letter-topic",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.deadLetterTopic]])]),e("div",null,[t[66]||(t[66]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Max Delivery Attempts ",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=b=>a.value.maxDeliveryAttempts=b),type:"number",min:"1",max:"100",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.maxDeliveryAttempts,void 0,{number:!0}]])])])):h("",!0)]),e("div",ea,[e("label",ta,[m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=b=>a.value.enableRetryPolicy=b),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableRetryPolicy]]),t[67]||(t[67]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Retry Policy",-1))]),a.value.enableRetryPolicy?(d(),i("div",aa,[e("div",null,[t[68]||(t[68]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Minimum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":t[12]||(t[12]=b=>a.value.minimumBackoff=b),type:"text",placeholder:"10s (e.g., 1s, 30s, 5m)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.minimumBackoff]])]),e("div",null,[t[69]||(t[69]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Maximum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=b=>a.value.maximumBackoff=b),type:"text",placeholder:"600s (e.g., 1m, 10m, 1h)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.maximumBackoff]])])])):h("",!0)])])])):(d(),i("div",sa,[e("div",ra,[e("div",oa,[T(N(pe),{class:"w-4 h-4 text-green-500"}),e("button",{onClick:oe(b=>ce(s),["stop"]),disabled:L.value||!s?.name,class:"inline-flex items-center text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200 transition-colors group disabled:opacity-50 disabled:cursor-not-allowed",title:"Edit subscription"},[e("span",null,f(_(s.name)),1),t[71]||(t[71]=e("svg",{class:"w-3 h-3 ml-1 opacity-60 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1))],8,la)]),e("button",{onClick:oe(b=>G(s),["stop"]),disabled:U.value||!s?.name,class:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete subscription"},[T(N(_e),{class:"w-4 h-4"})],8,na)]),e("div",da,[e("div",ia,[t[72]||(t[72]=e("span",{class:"font-medium"},"Type:",-1)),e("span",ua,f(s.pushConfig?.pushEndpoint?"Push":s.bigqueryConfig?"BigQuery":"Pull"),1)]),e("div",ca,[t[73]||(t[73]=e("span",{class:"font-medium"},"Ack Deadline:",-1)),j(" "+f(s?.ackDeadlineSeconds||60)+"s ",1)]),s?.pushConfig?.pushEndpoint?(d(),i("div",ma,[t[74]||(t[74]=e("span",{class:"font-medium"},"Endpoint:",-1)),j(" "+f(s.pushConfig.pushEndpoint),1)])):s?.bigqueryConfig?(d(),i("div",pa,[t[75]||(t[75]=e("span",{class:"font-medium"},"BigQuery Table:",-1)),j(" "+f(s.bigqueryConfig.table),1)])):h("",!0),e("div",ga,[t[76]||(t[76]=e("span",{class:"font-medium"},"Ordering:",-1)),j(" "+f(s?.enableMessageOrdering?"Enabled":"Disabled"),1)])]),s?.deadLetterPolicy||s?.retryPolicy?(d(),i("div",ba,[s?.deadLetterPolicy?(d(),i("div",ya,[t[77]||(t[77]=e("span",{class:"font-medium"},"Dead Letter:",-1)),j(" "+f(n(s.deadLetterPolicy.deadLetterTopic||""))+" ("+f(s.deadLetterPolicy.maxDeliveryAttempts)+" attempts) ",1)])):h("",!0),s?.retryPolicy?(d(),i("div",va,[t[78]||(t[78]=e("span",{class:"font-medium"},"Retry:",-1)),j(" "+f(s.retryPolicy.minimumBackoff)+" - "+f(s.retryPolicy.maximumBackoff),1)])):h("",!0)])):h("",!0)]))]))),128))])),h("",!0),I.value||E.value?(d(),i("div",xa,[e("h4",fa,f(y.value?"Edit Subscription":"Create New Subscription"),1),e("div",ka,[e("div",null,[t[97]||(t[97]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Name * ",-1)),m(e("input",{"onUpdate:modelValue":t[25]||(t[25]=s=>a.value.name=s),type:"text",placeholder:"subscription-name",class:K(["w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm",{"border-red-300 focus:border-red-500 focus:ring-red-500":a.value.errors?.name}])},null,2),[[w,a.value.name]]),a.value.errors?.name?(d(),i("p",ha,f(a.value.errors.name),1)):h("",!0)]),e("div",null,[t[99]||(t[99]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Delivery Type ",-1)),m(e("select",{"onUpdate:modelValue":t[26]||(t[26]=s=>a.value.deliveryType=s),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},[...t[98]||(t[98]=[e("option",{value:"pull"},"Pull",-1),e("option",{value:"push"},"Push",-1),e("option",{value:"bigquery"},"BigQuery",-1)])],512),[[Te,a.value.deliveryType]])]),a.value.deliveryType==="push"?(d(),i("div",wa,[t[100]||(t[100]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Push Endpoint * ",-1)),m(e("input",{"onUpdate:modelValue":t[27]||(t[27]=s=>a.value.pushEndpoint=s),type:"url",placeholder:"https://example.com/webhook",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.pushEndpoint]])])):h("",!0),a.value.deliveryType==="bigquery"?(d(),i("div",Sa,[e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," BigQuery Table * ",-1)),m(e("input",{"onUpdate:modelValue":t[28]||(t[28]=s=>a.value.bigqueryTable=s),type:"text",placeholder:"project.dataset.table",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.bigqueryTable]])]),e("div",Ta,[e("label",_a,[m(e("input",{"onUpdate:modelValue":t[29]||(t[29]=s=>a.value.useTopicSchema=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.useTopicSchema]]),t[102]||(t[102]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Use Topic Schema",-1))]),e("label",Da,[m(e("input",{"onUpdate:modelValue":t[30]||(t[30]=s=>a.value.writeMetadata=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.writeMetadata]]),t[103]||(t[103]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Write Metadata",-1))])]),t[104]||(t[104]=e("p",{class:"text-xs text-amber-600 dark:text-amber-400"}," ⚠️ Note: BigQuery subscriptions can be created but don't send messages to BigQuery in the emulator ",-1))])):h("",!0),e("div",Va,[t[105]||(t[105]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Ack Deadline (seconds) ",-1)),m(e("input",{"onUpdate:modelValue":t[31]||(t[31]=s=>a.value.ackDeadlineSeconds=s),type:"number",min:"10",max:"600",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.ackDeadlineSeconds,void 0,{number:!0}]])]),e("div",$a,[e("label",Ba,[m(e("input",{"onUpdate:modelValue":t[32]||(t[32]=s=>a.value.enableMessageOrdering=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableMessageOrdering]]),t[106]||(t[106]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Message Ordering",-1))])]),e("div",Na,[e("label",Ca,[m(e("input",{"onUpdate:modelValue":t[33]||(t[33]=s=>a.value.enableDeadLetter=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableDeadLetter]]),t[107]||(t[107]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Dead Letter Policy",-1))]),a.value.enableDeadLetter?(d(),i("div",Ea,[e("div",null,[t[108]||(t[108]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Dead Letter Topic ",-1)),m(e("input",{"onUpdate:modelValue":t[34]||(t[34]=s=>a.value.deadLetterTopic=s),type:"text",placeholder:"projects/project/topics/dead-letter-topic",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.deadLetterTopic]])]),e("div",null,[t[109]||(t[109]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Max Delivery Attempts ",-1)),m(e("input",{"onUpdate:modelValue":t[35]||(t[35]=s=>a.value.maxDeliveryAttempts=s),type:"number",min:"5",max:"100",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.maxDeliveryAttempts,void 0,{number:!0}]])])])):h("",!0)]),e("div",Ma,[e("label",Ua,[m(e("input",{"onUpdate:modelValue":t[36]||(t[36]=s=>a.value.enableRetryPolicy=s),type:"checkbox",class:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"},null,512),[[R,a.value.enableRetryPolicy]]),t[110]||(t[110]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Enable Retry Policy",-1))]),a.value.enableRetryPolicy?(d(),i("div",La,[e("div",null,[t[111]||(t[111]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Minimum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":t[37]||(t[37]=s=>a.value.minimumBackoff=s),type:"text",placeholder:"10s (e.g., 1s, 30s, 5m)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.minimumBackoff]])]),e("div",null,[t[112]||(t[112]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Maximum Backoff ",-1)),m(e("input",{"onUpdate:modelValue":t[38]||(t[38]=s=>a.value.maximumBackoff=s),type:"text",placeholder:"600s (e.g., 1m, 10m, 1h)",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm"},null,512),[[w,a.value.maximumBackoff]])])])):h("",!0)])])])):h("",!0)])])):h("",!0),T($e,{modelValue:W.value,"onUpdate:modelValue":t[39]||(t[39]=s=>W.value=s),title:"Delete Subscription",message:`Are you sure you want to delete subscription '${M.value?_(M.value.name):""}'?`,"confirm-label":"Delete Subscription","is-loading":U.value,details:{title:"What will happen:",description:"The subscription will be permanently deleted and will stop receiving messages from this topic."},onConfirm:se,onCancel:J},null,8,["modelValue","message","is-loading"])]),_:1},8,["modelValue","title","actions"]))}}),Pa={class:"space-y-6"},Ra={key:0,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ja={key:1,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Oa={class:"text-center"},qa={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},Ia={class:"mt-4"},Fa={key:2,class:"space-y-6"},Qa={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},za={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},Ha={class:"flex items-center justify-between"},Ya={class:"text-lg font-medium text-gray-900 dark:text-white"},Wa={class:"flex items-center space-x-3"},Xa=["disabled"],Za={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},Ka={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ga=["id","onClick"],Ja={class:"flex items-start justify-between cursor-pointer"},es={class:"flex items-start space-x-3 flex-1 cursor-pointer"},ts={class:"flex-1 min-w-0 cursor-pointer"},as={class:"flex items-center space-x-2 mb-1"},ss=["onClick"],rs={key:0,class:"flex items-center"},os={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},ls={class:"mt-2 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 text-xs cursor-pointer"},ns={class:"flex items-center text-gray-600 dark:text-gray-400 cursor-pointer"},ds={key:0,class:"flex items-center text-gray-600 dark:text-gray-400 cursor-pointer"},is={class:"truncate"},us={class:"flex items-center text-gray-600 dark:text-gray-400 cursor-pointer"},cs={key:1,class:"flex items-center text-gray-600 dark:text-gray-400 cursor-pointer"},ms={key:0,class:"mt-2 flex flex-wrap gap-1"},ps={class:"flex items-center space-x-2 ml-4"},gs=["onClick"],bs=["onClick"],ys=["onClick","disabled"],vs={key:3,class:"space-y-6"},xs={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},fs={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},ks={class:"flex items-center justify-between"},hs={class:"flex items-center space-x-3"},ws=["disabled"],Ss={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Ts={class:"text-center py-12"},_s={class:"mt-2 text-gray-600 dark:text-gray-400"},Ds={class:"mt-6"},Ps=ve({__name:"TopicsListView",setup(V){const Y=xe(),B=Ne(),z=fe(),ae=De(),C=x(!1),O=x(null),k=x([]),v=x(!1),P=x(!1),D=x(""),F=x(!1),U=x(!1),L=x(null),S=x(!1),q=x(null),I=x(null),E=te(()=>Y.params.projectId),y=g=>{const o=g.split("/");return o[o.length-1]||g},W=g=>{const o=g.split("/");return o[o.length-1]||g},M=async()=>{if(!E.value){O.value="No project selected";return}C.value=!0,O.value=null;try{const g=await me.getTopics(E.value),o=await ee.getSubscriptions(E.value),p=new Map;(Array.isArray(o)?o:[]).forEach(G=>{const se=G.topic||G.topicName,J=typeof se=="string"?se.split("/").pop():null;if(J){const r=p.get(J)||0;p.set(J,r+1)}});const Z=g.map(G=>{const se=G.name?.split("/").pop()||"",J=p.get(se)||0;return{...G,subscriptionsCount:J}});k.value=Z}catch(g){console.error("Error fetching topics:",g),g.response?.status===404?O.value=`Project "${E.value}" not found. Make sure the project exists in the emulator.`:g.code==="ECONNREFUSED"||g.message.includes("Network Error")?O.value="Cannot connect to the Pub/Sub emulator. Please check if it's running.":O.value=g.message||"Failed to load topics"}finally{C.value=!1}},A=g=>{D.value=y(g.name),P.value=!0},a=()=>{M()},X=()=>{M()},c=()=>{M()},l=g=>{L.value=g,U.value=!0},n=async()=>{if(!L.value)return;const g=L.value,o=y(g.name);F.value=!0;try{await ae.deleteTopic(o,E.value),k.value=k.value.filter(p=>p.name!==g.name),z.showToast({type:"success",title:"Topic Deleted",message:`Topic "${o}" and all related subscriptions have been deleted successfully`})}catch(p){console.error("Error deleting topic:",p);let Q="Failed to delete topic";p.response?.status===404&&(Q="Topic not found or already deleted",k.value=k.value.filter(Z=>Z.name!==g.name)),z.showToast({type:"error",title:"Delete Failed",message:Q})}finally{F.value=!1,U.value=!1,L.value=null}},_=()=>{U.value=!1,L.value=null},u=g=>{q.value=g,S.value=!0},H=g=>{I.value=g,q.value=g,S.value=!0},ge=()=>{},ue=g=>{const o=y(g.name);B.push({name:"project-subscriptions",params:{projectId:E.value},hash:`#${o}`})},ce=async()=>{const g=Y.hash.slice(1)||window.location.hash.slice(1);g&&k.value.length>0&&await Me(g,"topic")};return le(()=>E.value,(g,o)=>{g!==o&&o&&(ae.clearProjectData(o),k.value=[],O.value=null,g&&M())},{immediate:!1}),le(()=>k.value.length,g=>{g>0&&ce()}),le(()=>Y.hash,g=>{g&&k.value.length>0&&ce()},{immediate:!0}),Ce(()=>{M()}),(g,o)=>(d(),i("div",Pa,[C.value?(d(),i("div",Ra,[...o[7]||(o[7]=[Ee('<div class="animate-pulse"><div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4"></div><div class="space-y-3"><div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"></div><div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/6"></div></div></div>',1)])])):O.value?(d(),i("div",ja,[e("div",Oa,[T(N(Le),{class:"mx-auto h-12 w-12 text-red-400"}),o[9]||(o[9]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},"Error Loading Topics",-1)),e("p",qa,f(O.value),1),e("div",Ia,[e("button",{onClick:M,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},[T(N(be),{class:"h-4 w-4 mr-2"}),o[8]||(o[8]=j(" Retry ",-1))])])])])):k.value.length>0?(d(),i("div",Fa,[e("div",Qa,[e("div",za,[e("div",Ha,[e("h2",Ya," Topics ("+f(k.value.length)+") ",1),e("div",Wa,[e("button",{onClick:o[0]||(o[0]=p=>v.value=!0),class:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},[T(N(ne),{class:"h-4 w-4 mr-2"}),o[10]||(o[10]=j(" Create Topic ",-1))]),e("button",{onClick:M,disabled:C.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[T(N(be),{class:K(["h-4 w-4 mr-2",{"animate-spin":C.value}])},null,8,["class"]),o[11]||(o[11]=j(" Refresh ",-1))],8,Xa)])])])]),e("div",Za,[e("div",Ka,[(d(!0),i(de,null,ie(k.value,p=>(d(),i("div",{key:p.name,id:`topic-${y(p.name)}`,onClick:Q=>H(p),class:K(["px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer",I.value?.name===p.name?"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500":""])},[e("div",Ja,[e("div",es,[T(N(he),{class:"h-5 w-5 text-blue-500 mt-0.5 shrink-0"}),e("div",ts,[e("div",as,[e("button",{onClick:oe(Q=>A(p),["stop"]),class:"inline-flex items-center text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200 transition-colors group"},[e("span",null,f(y(p.name)),1),o[12]||(o[12]=e("svg",{class:"w-3 h-3 ml-1 opacity-60 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1))],8,ss),p.schemaSettings?(d(),i("div",rs,[...o[13]||(o[13]=[e("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200"},[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),j(" Schema ")],-1)])])):h("",!0)]),e("p",os,f(p.name),1),e("div",ls,[e("div",ns,[o[14]||(o[14]=e("svg",{class:"w-3 h-3 mr-1.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o[15]||(o[15]=e("span",{class:"font-medium mr-1"},"Retention:",-1)),e("span",null,f(p.messageRetentionDuration||"7d (default)"),1)]),p.schemaSettings?(d(),i("div",ds,[o[16]||(o[16]=e("svg",{class:"w-3 h-3 mr-1.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),o[17]||(o[17]=e("span",{class:"font-medium mr-1"},"Schema:",-1)),e("span",is,f(W(p.schemaSettings.schema)),1)])):h("",!0),e("div",us,[o[18]||(o[18]=e("svg",{class:"w-3 h-3 mr-1.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1)),o[19]||(o[19]=e("span",{class:"font-medium mr-1"},"Subscriptions:",-1)),e("span",null,f(p.subscriptionsCount||0),1)]),p.kmsKeyName?(d(),i("div",cs,[...o[20]||(o[20]=[e("svg",{class:"w-3 h-3 mr-1.5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m0 0a2 2 0 012 2 2 2 0 01-2 2 2 2 0 01-2-2m2-2H9a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V9a2 2 0 00-2-2z"})],-1),e("span",{class:"font-medium mr-1"},"Encrypted:",-1),e("span",{class:"text-green-600 dark:text-green-400"},"Yes",-1)])])):h("",!0)]),p.labels&&Object.keys(p.labels).length>0?(d(),i("div",ms,[(d(!0),i(de,null,ie(p.labels,(Q,Z)=>(d(),i("span",{key:Z,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"},f(Z)+": "+f(Q),1))),128))])):h("",!0)])]),e("div",ps,[(p.subscriptionsCount||0)>0?(d(),i("button",{key:0,onClick:oe(Q=>ue(p),["stop"]),class:"p-1.5 text-gray-400 hover:text-green-500 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",title:"View subscriptions"},[T(N(pe),{class:"w-4 h-4"})],8,gs)):h("",!0),e("button",{onClick:oe(Q=>u(p),["stop"]),class:K(["p-1.5 text-gray-400 hover:text-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",I.value?.name===p.name?"text-blue-500 bg-blue-50 dark:bg-blue-900/20":""]),title:"Publish message"},[T(N(Ae),{class:"w-4 h-4"})],10,bs),e("button",{onClick:oe(Q=>l(p),["stop"]),disabled:F.value,class:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete topic"},[T(N(_e),{class:"w-4 h-4"})],8,ys)])])],10,Ga))),128))])])])):(d(),i("div",vs,[e("div",xs,[e("div",fs,[e("div",ks,[o[23]||(o[23]=e("h2",{class:"text-lg font-medium text-gray-900 dark:text-white"}," Topics (0) ",-1)),e("div",hs,[e("button",{onClick:o[1]||(o[1]=p=>v.value=!0),class:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},[T(N(ne),{class:"h-4 w-4 mr-2"}),o[21]||(o[21]=j(" Create Topic ",-1))]),e("button",{onClick:M,disabled:C.value,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[T(N(be),{class:K(["h-4 w-4 mr-2",{"animate-spin":C.value}])},null,8,["class"]),o[22]||(o[22]=j(" Refresh ",-1))],8,ws)])])])]),e("div",Ss,[e("div",Ts,[T(N(he),{class:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-600"}),o[25]||(o[25]=e("h3",{class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"}," No topics yet ",-1)),e("p",_s,' Get started by creating your first topic for project "'+f(E.value)+'" ',1),e("div",Ds,[e("button",{onClick:o[2]||(o[2]=p=>v.value=!0),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 transition-colors"},[T(N(ne),{class:"h-4 w-4 mr-2"}),o[24]||(o[24]=j(" Create Topic ",-1))])])])])])),T(St,{modelValue:v.value,"onUpdate:modelValue":o[3]||(o[3]=p=>v.value=p),onTopicCreated:a},null,8,["modelValue"]),T(Aa,{modelValue:P.value,"onUpdate:modelValue":o[4]||(o[4]=p=>P.value=p),"topic-name":D.value,"project-id":E.value,onTopicUpdated:X,onSubscriptionsChanged:c},null,8,["modelValue","topic-name","project-id"]),T($e,{modelValue:U.value,"onUpdate:modelValue":o[5]||(o[5]=p=>U.value=p),title:"Delete Topic",message:`Are you sure you want to delete topic '${L.value?y(L.value.name):""}'?`,"confirm-label":"Delete Topic","is-loading":F.value,details:{title:"What will happen:",description:"The topic and all its messages will be permanently deleted. Subscriptions will lose access to this topic."},onConfirm:n,onCancel:_},null,8,["modelValue","message","is-loading"]),T(Pe,{modelValue:S.value,"onUpdate:modelValue":o[6]||(o[6]=p=>S.value=p),"topic-name":q.value?.name?y(q.value.name):"","project-id":E.value,onMessagePublished:ge},null,8,["modelValue","topic-name","project-id"])]))}});export{Ps as default};
